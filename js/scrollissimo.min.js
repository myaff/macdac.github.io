/**
 * Scrollissimo
 * Javascript plugin for smooth scroll-controlled animations
 * @version 0.5.0
 * @author frux <qdinov@yandex.ru>
 * @url https://github.com/Promo/scrollissimo
 */
!function(t,e){function i(){return Math.max(t.body.scrollHeight,t.documentElement.scrollHeight)}function n(t,e,i,n){var o,s,r=Math.min(i,n),a=Math.max(i,n),h=t,m=e;if(h>=r&&a>=h)o=h,s=Math.min(a,m);else if(a>=m&&m>=r)o=Math.max(r,h),s=Math.min(a,m);else{if(!(r>=h&&m>=a))return;o=r,s=a}return n>i?{from:o,to:s}:{from:s,to:o}}function o(t,e,i){return isNaN(i)?c.push(new u(t,e,i)):d.push(new u(t,e,i)),this}function s(t,e){c.forEach(function(e){e.render(t)}),d.forEach(function(i){e?i._smoother.smooth(l,t):i.render(t)})}function r(t){var i=isNaN(t)?e.pageYOffset:t;s(i,m.enableSmoothing),l=i}function a(t){f||(r(t),isNaN(t)&&setTimeout(r,10))}var h,m,u,c=[],d=[],f=!0,l=0;!function(){var t,i=["ms","moz","webkit","o"],n=i.length;if(e.requestAnimationFrame)e._rAF=e.requestAnimationFrame;else{for(t=0;n>t&&!e.requestAnimationFrame;t+=1)e._rAF=e[i[t]+"RequestAnimationFrame"]&&e[i[t]+"RequestAnimationFrame"];!e._rAF&&(e._rAF=function(t){return setTimeout(function(){t()},1e3/60)})}}(),u=function(t,e,i){t&&(this.params={start:e||0,duration:t.duration()||0},this.timeline=t.pause(),isNaN(i)||(this._maxSpeed=i,this._smoother=new u.Smoother(this,this._maxSpeed)))},u.prototype.getIntersection=function(t,e){return n(this.params.start,this.params.start+this.timeline.duration()*this.timeline.timeScale(),t,e)},u.prototype.render=function(t){var e=Math.round((t-this.params.start)/this.timeline.duration()*this.timeline.timeScale()*1e3)/1e3;return 0>e&&(e=0),e>1&&(e=1),this.timeline.progress(e),this},u.Smoother=function(t,e){this.status="idle",this.animateTo=0,this.maxSpeed=+e,this.queue=t},u.Smoother.prototype.smooth=function(t,i){var n=this.queue.getIntersection(t,i);return n?(this.animateTo=n.to,this.animateFrom=this.animateFrom||n.from,"idle"===this.status&&(this.status="busy",this.id=e._rAF(this.step.bind(this))),this):void 0},u.Smoother.prototype.step=function(){var t=this.animateTo-this.animateFrom;Math.abs(t)>this.maxSpeed?(this.queue.render(this.animateFrom+=this.maxSpeed*(t>0?1:-1)),e._rAF(this.step.bind(this))):(this.queue.render(this.animateTo),this.status="idle",this.animateFrom=this.animateTo)},t.addEventListener("DOMContentLoaded",function(){var t=[],n=+new Date;h=i(),setTimeout(function(){var t=e.pageYOffset;l=t,s(t,!1),f=!1},100),m._isTouchMode?m.enableSmoothing=!1:(stepwiseDetector=function(e){var i=!1;if(5===t.length&&window.removeEventListener("wheel",stepwiseDetector),t.push(e.deltaY),+new Date-n<=400){if(5===t.length){for(var o=0;5>o;o++)if(Math.abs(t[o])>100){i=!0;break}m.enableSmoothing=i}}else n=+new Date,t=[]},window.addEventListener("wheel",stepwiseDetector))}),m={add:o,knock:a,enableSmoothing:!0,_isTouchMode:"ontouchstart"in e,_test:{_setRenderFunc:function(t){u.prototype._render=t},_getIntersection:n}},"object"==typeof module?module.exports=m:e.Scrollissimo=m}(document,window);